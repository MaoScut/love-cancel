<script type="text/javascript">
function getRangeRandom(low, height) {
	return Math.floor(Math.random() * (height - low) + low);
}

function createNewElement() {
	let rand = getRangeRandom(1, 6);
	return {
		key: uuid.v4(),
		color: rand,
	}
}

function createDifferentColorMatrix(rows, cols, colors) {
	let matrix = createRandomColorMatrix(rows, cols, colors);
	// console.log('before');
	// matrix.forEach(v => console.log(v));
	let conflictNum = Infinity;
	let wTime = 0;
	function modifyColor(i, j) {
		let num = 0;
		let candidate = [[i-1, j], [i, j+1], [i+1, j], [i, j-1]];
		let colorAround = [];
		for (let k = 0; k < candidate.length; k ++) {
			let [rowIndex, colIndex] = candidate[k];
			if(rowIndex == -1 || colIndex == -1 || rowIndex == rows || colIndex == cols)
				num += 0;
			else {
				colorAround.push(matrix[rowIndex][colIndex]);
				if(matrix[i][j] == matrix[rowIndex][colIndex]) 
					num ++;
			}
		}
		if(num == 0) return 0;
		else {
			// first we find a min conflict color
			let c = Infinity;
			let colorIndex;
			for(let i = 0; i < colors.length; i ++) {
				let _c = 0;
				for(let j = 0; j < colorAround.length; j ++) {
					if(colorAround[j] == colors[i])
						_c ++
				}
				if(_c < c) {
					c = _c;
					colorIndex = colors[i];
				}
			}
			// modify the color at row i col j
			matrix[i][j] = colorIndex;
			return c;
		}
	}
	while(conflictNum > 0) {
		conflictNum = 0;
		wTime ++;
		for(let i = 0; i < rows; i ++) {
			for(let j = 0; j < cols; j ++) {
				conflictNum += modifyColor(i, j);
			}
		}
	}
	console.log('after');
	matrix.forEach(v => console.log(v));
	console.log('while excute times: ' + wTime);
	return matrix;
}
createDifferentColorMatrix(5, 5, [1,2,3,4]);
/**
 * [createRandomColorMatrix description]
 * @param  {[type]} rows   [description]
 * @param  {[type]} cols   [description]
 * @param  {[type]} colors [description]
 * @return {[type]}        [description]
 */
function createRandomColorMatrix(rows, cols, colors) {
	let matrix = new Array(rows);
	for(let i = 0; i < rows; i ++) {
		let rowCell = new Array(cols);
		for(let j = 0; j < cols; j ++) {
			rowCell[j] = getRangeRandom(colors[0], colors.length + 1);
		}
		matrix[i] = rowCell;
	}
	return matrix;
}
</script>